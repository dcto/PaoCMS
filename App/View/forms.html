{#搜索框#}
{% macro search() %}
<form id="search" class="form-inline" action="{{ url() }}?">
    <div class="form-group">
        <div class="input-group">
            {#<div class="input-group-addon">{{ e('username') }}</div>#}
            <input type="text" class="form-control" id="w" name="w" placeholder="关键字">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-default">{{lang.search}}</button>
                </span>
        </div>
    </div>
</form>
{% endmacro %}

{#输入框#}
{% macro text(name, size=3, value='',  message='') %}
<div class="form-group">
    <div class="col-md-{{ size }}">
        <label for="{{ name }}" class="control-label text-right">{{lang(name)}}：</label>
        <input id="{{ name }}" name="{{ name }}" type="text" class="form-control" placeholder="{{ lang('form.input', lang(name))}}" value="{{value}}" />
    </div>
</div>
{% endmacro %}

{#选择列表#}
{% macro select(name, options, title, size=3) %}
<div class="form-group">
    <div class="col-md-{{ size }}">
        <label class="control-label text-right">{{ title }}：</label>
        <select name="gid" class="form-control">
            <option value="0">{{lang.select}}{{ title }}</option>
            {%for option in options%}
                <option value="{{option.id}}">{{option.name}}</option>
            {%endfor%}
        </select>
    </div>
</div>
{% endmacro %}

{#选择表单#}
{% macro checkbox(name, checked, label) %}
    {% set id = name|default(random()) %}
    <div class="checkbox checkbox-circle checkbox-success checkbox-inline">
        <input id="{{ id }}" type="checkbox" name="{{ name }}"{{ checked ? ' checked=checked' }} /><label for="{{ id }}">{{ label?: lang.status }}</label>
    </div>
{% endmacro %}

{#radio表单#}
{% macro radio(name, checked, size=3) %}
    {% set id = name|default(random()) %}
<div class="form-group">
    <div class="col-md-{{ size }}">
        <label class="control-label">{{lang.config}}{{lang(name)}}：</label>
        <div class="radio radio-circle radio-inline">
            <input id="{{ id }}-1" type="radio" name="{{ name }}" value="0"{{ checked==0 ? ' checked=checked' }} /><label for="{{ id }}-1">{{ lang('disable') }}</label>
        </div>
        <div class="radio radio-circle radio-inline radio-success">
            <input id="{{ id }}-2" type="radio" name="{{ name }}" value="1"{{ checked==1 ? ' checked=checked' }} /><label for="{{ id }}-2">{{ lang('enable') }}</label>
        </div>
    </div>
</div>
{% endmacro %}

{% macro file(name) %}
    <div class="form-group">
        <label class="control-label">{{ lang(name) }}</label>
        <input id="{{ name }}" type="file" class="file">
    </div>
{% endmacro %}

{% macro textarea(name, row=3) %}
<div class="form-group">
    <label class="control-label">{{ lang(name) }}</label>
    <textarea id="{{ name }}" name="{{ name }}" class="form-control" rows="{{ row }}"></textarea>
</div>
{% endmacro %}

{% macro upload(name) %}
    <div class="form-group">
        <label class="control-label">{{ lang(name) }}</label>
        <!-- image-preview-filename input [CUT FROM HERE]-->
        <div class="col-md-4 input-group image-preview">
            <input type="text" class="form-control image-preview-filename" disabled="disabled"> <!-- don't give a name === doesn't send on POST/GET -->
                <span class="input-group-btn">
                    <!-- image-preview-clear button -->
                    <button type="button" class="btn btn-sm btn-default image-preview-clear" style="display:none;">
                        <span class="glyphicon glyphicon-remove"></span> Clear
                    </button>
                    <!-- image-preview-input -->
                    <div class="btn btn-sm btn-default image-preview-input">
                        <span class="glyphicon glyphicon-folder-open"></span>
                        <span class="image-preview-input-title">Browse</span>
                        <input type="file" accept="image/png, image/jpeg, image/gif" name="input-file-preview"/> <!-- rename it -->
                    </div>
                </span>
        </div><!-- /input-group image-preview [TO HERE]-->
    </div>
    <script type="text/javascript">
        $(document).on('click', '#close-preview', function(){
            $('.image-preview').popover('hide');
            // Hover befor close the preview
            $('.image-preview').hover(
                    function () {
                        $('.image-preview').popover('show');
                    },
                    function () {
                        $('.image-preview').popover('hide');
                    }
            );
        });

        $(function() {
            // Create the close button
            var closebtn = $('<button/>', {
                type:"button",
                text: 'x',
                id: 'close-preview',
                style: 'font-size: initial;',
            });
            closebtn.attr("class","close pull-right");
            // Set the popover default content
            $('.image-preview').popover({
                trigger:'manual',
                html:true,
                title: "<strong>Preview</strong>"+$(closebtn)[0].outerHTML,
                content: "There's no image",
                placement:'bottom'
            });
            // Clear event
            $('.image-preview-clear').click(function(){
                $('.image-preview').attr("data-content","").popover('hide');
                $('.image-preview-filename').val("");
                $('.image-preview-clear').hide();
                $('.image-preview-input input:file').val("");
                $(".image-preview-input-title").text("Browse");
            });
            // Create the preview image
            $(".image-preview-input input:file").change(function (){
                var img = $('<img/>', {
                    id: 'dynamic',
                    width:250,
                    height:200
                });
                var file = this.files[0];
                var reader = new FileReader();
                // Set preview image into the popover data-content
                reader.onload = function (e) {
                    $(".image-preview-input-title").text("Change");
                    $(".image-preview-clear").show();
                    $(".image-preview-filename").val(file.name);
                    img.attr('src', e.target.result);
                    $(".image-preview").attr("data-content",$(img)[0].outerHTML).popover("show");
                }
                reader.readAsDataURL(file);
            });
        });
        var uploader = WebUploader.create({
            swf: '{{ asset('/plugins/webuploader/Upload.swf') }}', // swf文件路径
            server: 'http://webuploader.duapp.com/server/fileupload.php',// 文件接收服务端。

            // 选择文件的按钮。可选。
            // 内部根据当前运行是创建，可能是input元素，也可能是flash.
            pick: '#picker',

            // 不压缩image, 默认如果是jpeg，文件上传前会压缩一把再上传！
            resize: false
        });

    </script>
{% endmacro %}

{% macro ueditor(name) %}
<div class="form-group">
    <label class="control-label">{{ lang(name) }}</label>
    <script id="{{ name }}" name="{{ name }}" type="text/plain"></script>
    <script type="text/javascript">
        var ue = UE.getEditor('content', {
            serverUrl: '',
            lang:'zh-cn',
            initialFrameWidth:"100%",
            autoHeightEnabled: true
        });
    </script>
</div>
{% endmacro %}

{#提交按扭#}
{% macro submit(value, size) %}
<div class="form-group">
        <input type="text" name="id" class="hide" />
        <button type="submit" data-loading="loading..." class="btn btn-primary {{ size }}">{{value|default(lang.submit)}}</button>
</div>
{% endmacro %}

{#状态展示#}
{% macro status(value, id) %}
    <a href="{{ url(request.path~'/update?id='~id) }}" data-status="{{ value?0:1 }}" class="btn-status label label-{{ value?'success':'default' }}">{{ lang(value?'enable':'disable') }}</a>
{% endmacro %}

{#修改删除按扭#}
{% macro operate(id, name='', extend='') %}
    {% if extend %}
    <a href="{{ extend.url }}" data-id="{{ id }}" class="btn-{{ extend.name }} btn btn-xs btn-primary">{{ extend.title|default(lang('menu.'~extend.name)) }}</a>
    &nbsp;
    {% endif %}
    <a href="{{ url(request.path~'/update?id='~id) }}" data-id="{{ id }}" class="btn-update btn btn-xs btn-info">{{ lang('update') }}</a>
    &nbsp;
    <a href="{{ url(request.path~'/delete?id='~id) }}" data-id="{{ id }}" class="btn-delete btn btn-xs btn-danger" data-confirm="{{ lang('alert.delete_confirm')|format(name) }}">{{ lang('delete') }}</a>
{% endmacro %}


{#表格编辑器#}
{% macro edit(name, type='text', title, value) %}
    <a href="#" class="editable editable-click editable-empty" id="{{ name }}" data-type="{{ type }}" data-name="{{ name }}" data-title="{{ title|default(lang('form.input', lang(name))) }}" data-original-title="{{ title|default(lang('form.input', lang(name))) }}"></a>
{% endmacro %}